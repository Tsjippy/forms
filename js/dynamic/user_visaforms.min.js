var user_visa  = new function(){console.log('Dynamic user_visa forms js loaded');document.addEventListener('DOMContentLoaded',function(){FormFunctions.tidyMultiInputs();let forms=document.querySelectorAll(`[data-formid="13"]`);forms.forEach(form=>{form.querySelectorAll(`select, input, textarea`).forEach(el=>user_visa.p(el));});});var prevEl='';var q=function(event){var el=event.target;form=el.closest('form');var n=el.getAttribute('name');if(n==''||n==undefined){if(el.closest('.nice-select-dropdown')!=null&&el.closest('.inputwrapper')!=null){el.closest('.inputwrapper').querySelectorAll('select').forEach(select=>{if(el.dataset.value==select.value){el=select;n=select.name;}});}else{return;}}if(el==prevEl){return;}prevEl=el;setTimeout(function(){prevEl='';},50);if(n=='nextBtn'){FormFunctions.nextPrev(1);}else if(n=='prevBtn'){FormFunctions.nextPrev(-1);}user_visa.p(el);};window.addEventListener('click',q);window.addEventListener('input',q);this.p=function(el){var n=el.getAttribute('name');var form=el.closest('form');if(n=='visa_info[permit_type][]'){var v_1=FormFunctions.getFieldValue('visa_info[permit_type][]',form,true,'greencard',true);var v_3=FormFunctions.getFieldValue('visa_info[permit_type][]',form,true,'accompanying',true);if(v_1=='greencard'||v_3=='accompanying'){form.querySelectorAll(`[name="greencard_expiry_date_label"], [name="visa_info[passport_name]"], [name="visa_info[nin]"], [name="upload_your_passport_and_greencard_copy_in_one_file_label"], [name="visa_info[passport_and_greencard_files]_files[]"]`).forEach(el=>{if(!el.closest('.inputwrapper').matches('.action-processed')){el.closest('.inputwrapper').classList.add('action-processed');FormFunctions.changeVisibility('remove',el,user_visa.p);}});document.querySelectorAll('.action-processed').forEach(el=>{el.classList.remove('action-processed')});}if(v_1!='greencard'&&v_3!='accompanying'){form.querySelectorAll(`[name="greencard_expiry_date_label"], [name="visa_info[passport_name]"], [name="visa_info[nin]"], [name="upload_your_passport_and_greencard_copy_in_one_file_label"], [name="visa_info[passport_and_greencard_files]_files[]"]`).forEach(el=>{if(!el.closest('.inputwrapper').matches('.action-processed')){el.closest('.inputwrapper').classList.add('action-processed');FormFunctions.changeVisibility('add',el,user_visa.p);}});document.querySelectorAll('.action-processed').forEach(el=>{el.classList.remove('action-processed')});}if(v_1=='greencard'){form.querySelectorAll(`[name="quota_position_label"], [name="visa_info[quota_position]"], [name="positions"], [name="upload_any_qualifications_you_have_label"], [name^="visa_info[qualifications]_files[]["]`).forEach(el=>{if(!el.closest('.inputwrapper').matches('.action-processed')){el.closest('.inputwrapper').classList.add('action-processed');FormFunctions.changeVisibility('remove',el,user_visa.p);}});document.querySelectorAll('.action-processed').forEach(el=>{el.classList.remove('action-processed')});}if(v_1!='greencard'){form.querySelectorAll(`[name="quota_position_label"], [name="visa_info[quota_position]"], [name="positions"], [name="upload_any_qualifications_you_have_label"], [name^="visa_info[qualifications]_files[]["]`).forEach(el=>{if(!el.closest('.inputwrapper').matches('.action-processed')){el.closest('.inputwrapper').classList.add('action-processed');FormFunctions.changeVisibility('add',el,user_visa.p);}});document.querySelectorAll('.action-processed').forEach(el=>{el.classList.remove('action-processed')});}}};};if(typeof(urlSearchParams)=='undefined'){window.urlSearchParams=new URLSearchParams(window.location.search.replaceAll('&amp;','&'));}Array.from(urlSearchParams).forEach(array=>document.querySelectorAll(`[name^='${array[0]}']`).forEach(el=>FormFunctions.changeFieldValue(el,array[1],user_visa.p,el.closest('form'),)));

