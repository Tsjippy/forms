{"version":3,"file":"formbuilder.min.js","mappings":"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","sources":["webpack://forms/./formbuilder.js"],"sourcesContent":["var reorderingBusy, formWrapper, formElementWrapper, modal;\n\nconsole.log(\"Formbuilder.js loaded\");\n\n/* FUNCTIONS */\nfunction clearFormInputs(){\n\ttry {\n\t\t//Loop to clear the modalform\n\t\tmodal.querySelectorAll('input:not([type=hidden]), select, textarea, [name=insertafter], [name=element-id]').forEach(function(el){\n\t\t\tif(el.type == 'checkbox'){\n\t\t\t\tel.checked = false;\n\t\t\t}else{\n\t\t\t\tel.value = '';\n\t\t\t}\n\n\t\t\tif(el.type == 'textarea' && el.id != ''){\n\t\t\t\tlet editor = tinyMCE.get(el.id);\n\t\t\t\tif(editor != null){\n\t\t\t\t\teditor.setContent('');\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(el.type == \"select-one\"){\n\t\t\t\tFormFunctions.removeDefaultSelect(el);\n\t\t\t\t\n\t\t\t\tif(el._niceSelect != undefined){\n\t\t\t\t\tel._niceSelect.clear();\n\t\t\t\t\tel._niceSelect.update();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\thideConditionalfields(modal.querySelector('form'));\n\t}\n\tcatch(err) {\n\t\tconsole.error(err);\n\t}\n}\n\nfunction fixElementNumbering(form){\n\tform.querySelectorAll('.form-element-wrapper').forEach((el, index)=>{\n\t\tel.dataset.priority = index+1;\n\t});\n}\n\n// add new element\nasync function showEmptyModal(target){\n\ttarget.classList.add('clicked');\n\n\tlet formId\t\t\t\t\t= target.dataset.formId;\n\tif(formId == undefined){\n\t\tif(target.closest('.form-element-wrapper') != null){\n\t\t\tformId = target.closest('.form-element-wrapper').dataset.formId;\n\t\t}else{\n\t\t\tformId = document.querySelector('input[type=hidden][name=\"form-id\"').value;\n\t\t}\n\t}\n\t\n\tclearFormInputs();\n\n\t// Hide all\n\tmodal.querySelectorAll(\".shouldhide\").forEach(el=>el.classList.replace('shouldhide', 'hidden'))\n\t\n\tif(formElementWrapper != null){\n\t\tmodal.querySelector('[name=\"insertafter\"]').value = formElementWrapper.dataset.priority;\n\t}\n\t\n\tmodal.querySelector('[name=\"submit-form-element\"]').textContent = modal.querySelector('[name=\"submit-form-element\"]').textContent.replace('Change','Add');\n\t\n\tmodal.querySelector('.element-conditions-wrapper').innerHTML = Main.showLoader(null, false, 50, '', true);\n\t\n\tMain.showModal(modal);\n\n\tvar formData = new FormData();\n\tformData.append('elementid', '-1');\n\tformData.append('form-id', formId);\n\tvar response = await FormSubmit.fetchRestApi('forms/request_form_conditions_html', formData);\n\n\t//fill the element conditions tab\n\tmodal.querySelector('.element-conditions-wrapper').innerHTML = response;\n\n\t// Add nice selects\n\tmodal.querySelectorAll('.condition-select').forEach(function(select){\n\t\tMain.attachNiceSelect(select);\n\t});\n}\n\n//edit existing element\nasync function requestEditElementData(target){\n\ttarget.classList.add('clicked');\n\n\tlet elementId\t\t= formElementWrapper.dataset.id;\n\tlet formId\t\t\t= target.closest('.form-element-wrapper').dataset.formId;\n\tmodal.querySelector('[name=\"element-id\"]').value = formElementWrapper.dataset.id;\n\tmodal.originalhtml\t= target.outerHTML;\n\n\tlet editButton\t\t= target.outerHTML;\n\n\tlet loader\t\t\t= Main.showLoader(target);\n\n\tloader.querySelector('.loader').style.margin = '5px 19px 0px 19px';\n\tloader.classList.add('clicked');\n\t\n\tlet formData = new FormData();\n\tformData.append('elementid', elementId);\n\tformData.append('form-id', formId);\n\t\n\tlet response = await FormSubmit.fetchRestApi('forms/request_form_element', formData);\n\n\tif(response){\n\t\t//fill the form after we have clicked the edit button\n\t\tif(modal.querySelector('[name=\"add-form-element-form\"]') != null){\n\t\t\tmodal.querySelector('[name=\"add-form-element-form\"]').innerHTML = response.elementForm;\n\n\t\t\t//activate tiny mce's\n\t\t\tmodal.querySelectorAll('.wp-editor-area').forEach(el =>{\n\t\t\t\ttinymce.execCommand( 'mceRemoveEditor', false, el.id );\n\t\t\t\ttinymce.execCommand( 'mceAddEditor', false, el.id );\n\t\t\t});\n\t\t}\n\n\t\tshowCondionalFields(modal.querySelector('[name=\"formfield[type]\"]').value, modal.querySelector('[name=\"add-form-element-form\"]'));\n\n\t\t//fill the element conditions tab\n\t\tmodal.querySelector('.element-conditions-wrapper').innerHTML = response.conditionsHtml;\n\n\t\t// Add nice selects\n\t\tmodal.querySelectorAll('select').forEach(function(select){\n\t\t\tMain.attachNiceSelect(select);\n\t\t});\n\t\t\n\t\tMain.showModal(modal);\n\t\t\n\t\t//show edit button again\n\t\tloader.outerHTML\t= editButton;\n\t}\n}\n\n// Add a new element\nasync function addFormElement(target, copying=false){\n\tlet adding\t\t= true;\n\tlet editing\t\t= false;\n\n\tlet form\t\t= target.closest('form');\n\tif(form.querySelector('[name=\"element-id\"]').value != ''){\n\t\tediting\t\t= true;\n\t\tadding\t\t= false;\n\t}\n\t\n\tlet wrapper;\n\n\tlet referenceNode\t= document.querySelector('.form-elements .clicked');\n\t\n\t// we are adding the first element to the form \n\tif(referenceNode == null){\n\t\t// reload if we are not in the editing screen yet\n\t\tif( !window.location.href.includes('formbuilder=true')){\n\t\t\tlet combine\t= '&';\n\t\t\tif( !window.location.href.includes('?')){\n\t\t\t\tcombine = '?';\n\t\t\t}\n\t\t\twindow.location.href = window.location.href+combine+'formbuilder=true';\n\t\t\t\n\t\t\treturn;\n\t\t}\n\n\t\twrapper\t\t\t\t= document.querySelector('.form-elements');\n\n\t\tpriority\t\t\t= 1;\n\t}else{\n\t\twrapper\t\t\t\t= referenceNode.closest('.form-element-wrapper');\n\n\t\tpriority\t\t\t= parseInt(wrapper.dataset.priority) + 1;\n\t}\n\n\t// Show loader\n\tif(!editing){\n\t\tlet loader \t\t\t\t= Main.showLoader(wrapper, false);\n\t\tloader.dataset.priority\t= priority;\n\t\tloader.classList.add('form-element-wrapper');\n\t\tloader.dataset.id\t\t= -1;\n\n\t\t// make sure all priorities are correct\n\t\tfixElementNumbering(referenceNode.closest('form'));\n\n\t\tvar indexes\t= {};\n\t\tdocument.querySelectorAll(`.form-element-wrapper`).forEach(el => {\n\t\t\tindexes[el.dataset.id]\t= el.dataset.priority;\n\t\t})\n\t\t\n\t\tindexes\t\t\t\t\t\t= JSON.stringify(indexes);\n\t}\n\n\tlet response;\n\tif(copying){\n\t\tlet formData\t\t\t= new FormData();\n\t\tformData.append('element-id', wrapper.dataset.id);\n\t\tformData.append('form-id', wrapper.dataset.formId);\n\t\tformData.append('order', indexes);\n\n\t\tresponse\t= await FormSubmit.fetchRestApi('forms/copy_form_element', formData);\n\t}else if(editing){\n\t\tresponse\t= await FormSubmit.submitForm(target, 'forms/add_form_element');\n\t}else{\n\t\tresponse\t= await FormSubmit.submitForm(target, 'forms/add_form_element', indexes);\n\t}\n\n\tif(response){\n\t\t// New Element\n\t\tif(editing){\n\t\t\treferenceNode.closest('.form-element-wrapper').outerHTML = response.html;\n\t\t}else{\n\t\t\t//First clear any previous input\n\t\t\tclearFormInputs();\n\t\t\t\n\t\t\t// Replace loader with element\n\t\t\tdocument.querySelectorAll(`.loader-wrapper`).forEach(el=>el.outerHTML = response.html);\n\n\t\t\t//add resize listener\n\t\t\tform.querySelectorAll('.resizer').forEach(el=>{resizeOb.observe(el);});\n\t\t}\n\n\t\tMain.hideModals();\n\n\t\tMain.displayMessage(response.message);\n\n\t\tif(referenceNode != null){\n\t\t\treferenceNode.classList.remove('clicked');\n\t\t}\n\t}\n\n\t// Remove loaders\n\tdocument.querySelectorAll(`.loader-wrapper`).forEach(el=>el.remove());\n}\n\nasync function sendElementSize(el, widthPercentage){\n\tif(widthPercentage != el.dataset.widthPercentage && Math.abs(widthPercentage - el.dataset.widthPercentage)>5){\n\t\tel.dataset.widthPercentage = widthPercentage;\n\t\t\n\t\t//send new width over AJAX\n\t\tlet formData = new FormData();\n\t\tformData.append('form-id', el.closest('.form-element-wrapper').dataset.formId);\n\t\tformData.append('elementid', el.closest('.form-element-wrapper').dataset.id);\n\t\tformData.append('new-width', widthPercentage);\n\t\t\n\t\tlet response = await FormSubmit.fetchRestApi('forms/edit_formfield_width', formData);\n\n\t\tif(response){\n\t\t\tMain.hideModals();\n\n\t\t\tMain.displayMessage(response);\n\t\t}\n\t}\n}\n\nasync function removeElement(target){\n\tlet parent\t\t\t= target.parentNode;\n\tlet elementWrapper\t= target.closest('.form-element-wrapper');\n\tlet formId\t\t\t= elementWrapper.dataset.formId;\n\tlet elementIndex \t= elementWrapper.dataset.id;\n\tlet form\t\t\t= target.closest('form');\n\n\tMain.showLoader(target);\n\tlet loader\t\t\t= parent.querySelector('.loader-wrapper');\n\tloader.style.paddingRight = '10px';\n\tloader.classList.remove('loader-wrapper');\n\n\tlet formData = new FormData();\n\tformData.append('form-id', formId);\n\n\tformData.append('elementindex', elementIndex);\n\t\n\tlet response = await FormSubmit.fetchRestApi('forms/remove_element', formData);\n\n\tif(response){\n\t\t//remove the formelement row\n\t\telementWrapper.remove();\n\t\t\n\t\tfixElementNumbering(form);\n\n\t\tMain.displayMessage(response);\n\t}\n}\n\n //Fires after element reorder\nasync function reorderformelements(event){\n\tif(!reorderingBusy){\n\t\treorderingBusy = true;\n\n\t\tfixElementNumbering(event.item.closest('form'));\n\n\t\tlet formData = new FormData();\n\t\tformData.append('form-id', event.item.dataset.formId);\n\t\tformData.append('el-id', event.item.dataset.id);\n\n\t\tlet indexes\t= {};\n\t\tdocument.querySelectorAll(`.form-element-wrapper`).forEach(el => {\n\t\t\tindexes[el.dataset.id]\t= el.dataset.priority;\n\t\t})\n\t\t\n\t\tformData.append('indexes', JSON.stringify(indexes));\n\t\t\n\t\tlet response\t= await FormSubmit.fetchRestApi('forms/reorder-form-elements', formData);\n\n\t\tif(response){\n\t\t\treorderingBusy = false;\n\n\t\t\tMain.displayMessage(response);\n\t\t}\n\t}else{\n\t\tlet options = {\n\t\t\ticon: 'error',\n\t\t\ttitle: 'ordering already in progress, please wait',\n\t\t\tconfirmButtonColor: \"#bd2919\",\n\t\t};\n\n\t\tif(document.fullscreenElement != null){\n\t\t\toptions['target']\t= document.fullscreenElement;\n\t\t}\n\n\t\tSwal.fire(options);\n\t}\n}\n\nasync function saveFormConditions(target){\n\tlet response\t= await FormSubmit.submitForm(target, 'forms/save_element-conditions');\n\n\tif(response){\n\t\tMain.hideModals();\n\n\t\tMain.displayMessage(response);\n\t}\n}\n\nasync function saveFormSettings(target){\n\tlet response\t= await FormSubmit.submitForm(target, 'forms/save_form_settings');\n\n\tif(response){\n\t\tMain.displayMessage(response);\n\t}\n}\n\nasync function saveFormEmails(target){\n\tlet response\t= await FormSubmit.submitForm(target, 'forms/save_form_emails');\n\n\tif(response){\n\t\tMain.displayMessage(response);\n\t}\n}\n\n//listen to element size changes\nvar doit;\nconst resizeOb = new ResizeObserver(function(entries) {\n\tlet element = entries[0].target;\n\tif(element.parentNode != undefined){\n\t\tvar width\t= entries[0].contentRect.width\n\t\tvar widthPercentage = Math.round(width/element.parentNode.offsetWidth * 100);\n\t\t\n\t\t//Show percentage on screen\n\t\tlet el\t= element.querySelector('.width-percentage');\n\t\tif(widthPercentage < 99){\n\t\t\tel.textContent = widthPercentage + '%';\n\t\t}else if(el != null){\n\t\t\tel.textContent = '';\n\t\t}\n\t\t\n\t\tclearTimeout(doit);\n\t\tdoit = setTimeout(sendElementSize, 500, element, widthPercentage);\n\t}\n});\n\n//show conditional fields based on on the element type\nfunction showCondionalFields(type, form){\n\thideConditionalfields(form);\n\n\t// hide all elements who do not belong to this type\n\tform.querySelectorAll(`.element-option:not(.${type}, .reverse), .element-option.not-${type}`).forEach(el=>el.classList.replace('shouldhide', 'hidden'));\n\tform.querySelectorAll(`.element-option.${type}`).forEach(el=>el.classList.replace('hidden', 'shouldhide'));\n\n\t// Check if this is a multi answer element\n\tif(document.querySelector(`.clicked`) != null && document.querySelector(`.clicked`).closest(`.form-element-wrapper.multi-answer-element`) != null){\n\t\tform.querySelectorAll(`.element-option.multi-answer-element`).forEach(el=>el.classList.replace('hidden', 'shouldhide'));\n\t}\n\n\tswitch(type) {\n\t\tcase 'button':\n\t\tcase 'formstep':\n\t\tcase 'label':\n\t\t\tform.querySelector('[name=\"label-text\"] .element-type').textContent = type;\n\t\t\tbreak;\n\t\tcase 'info':\n\t\t\tform.querySelector('[name=\"infotext\"] .type').textContent = 'info-box';\n\t\t\tbreak;\n\t\tcase 'hcaptcha':\n\t\tcase 'recaptcha':\n\t\tcase 'turnstile':\n\t\t\tmodal.querySelectorAll(\".shouldhide\").forEach(el=>el.classList.replace('shouldhide', 'hidden'));\n\t\t\tmodal.querySelectorAll(`[name=\"elementname\"]`).forEach(el=>el.classList.replace('hidden', 'shouldhide'));\n\t\t\tbreak;\n\t\tcase 'radio':\n\t\tcase 'select':\n\t\tcase 'checkbox':\n\t\tcase 'datalist':\n\t\t\tbreak;\n\t\tcase 'p':\n\t\t\tform.querySelector('[name=\"infotext\"] .type').textContent = 'Paragraph';\n\t\t\tbreak;\n\t\tcase 'php':\n\t\t\tbreak;\n\t\tcase 'file':\n\t\tcase 'image':\n\t\t\tform.querySelectorAll('.filetype').forEach(el=>{el.textContent = type;});\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t} \n}\n\nfunction hideConditionalfields(form){\n\tform.querySelectorAll(`.element-option.reverse`).forEach(el=>el.classList.replace('hidden', 'shouldhide'));\n}\n\nfunction showOrHideIds(target){\n\n\tconst url \t\t= new URL(window.location);\n\n\tif(target.dataset.action == 'show'){\n\t\turl.searchParams.set('show-id', 1);\n\n\t\tformWrapper.querySelectorAll('.element-id.hidden').forEach(el=>el.classList.remove('hidden'));\n\t\t\n\t\ttarget.textContent \t\t= 'Hide ids';\n\t\ttarget.dataset.action\t= 'hide';\n\t}else{\n\t\turl.searchParams.delete('show-id');\n\n\t\tformWrapper.querySelectorAll('.element-id:not(.hidden)').forEach(el=>el.classList.add('hidden'));\n\t\t\n\t\ttarget.textContent \t\t= 'Show ids';\n\t\ttarget.dataset.action\t= 'show';\n\t}\n\t\n\twindow.history.pushState({}, '', url);\n}\n\nfunction showOrHideName(target){\n\tconst url \t\t= new URL(window.location);\n\n\tif(target.dataset.action == 'show'){\n\t\turl.searchParams.set('show-name', 1);\n\n\t\tformWrapper.querySelectorAll('.element-name.hidden').forEach(el=>el.classList.remove('hidden'));\n\t\t\n\t\ttarget.textContent \t\t= 'Hide names';\n\t\ttarget.dataset.action\t= 'hide';\n\t}else{\n\t\turl.searchParams.delete('show-id');\n\n\t\tformWrapper.querySelectorAll('.element-name:not(.hidden)').forEach(el=>el.classList.add('hidden'));\n\t\t\n\t\ttarget.textContent \t\t= 'Show names';\n\t\ttarget.dataset.action\t= 'show';\n\t}\n\n\twindow.history.pushState({}, '', url);\n}\n\nfunction maybeRemoveElement(target){\n\tif(typeof(Swal)=='undefined'){\n\t\tremoveElement(target);\n\t}else{\n\t\tlet options = {\n\t\t\ttitle: 'Are you sure?',\n\t\t\ttext: \"This will remove this element\",\n\t\t\ticon: 'warning',\n\t\t\tshowCancelButton: true,\n\t\t\tconfirmButtonColor: '#3085d6',\n\t\t\tcancelButtonColor: '#d33',\n\t\t\tconfirmButtonText: 'Yes, delete it!'\n\t\t}\n\n\t\tif(document.fullscreenElement != null){\n\t\t\toptions['target']\t= document.fullscreenElement;\n\t\t}\n\n\t\tSwal.fire(options).then((result) => {\n\t\t\tif (result.isConfirmed) {\n\t\t\t\tremoveElement(target);\n\t\t\t}\n\t\t})\n\t}\n}\n\nfunction showOrHideConditionFields(target){\n\t//show default conditional field\n\ttarget.closest('.rule-row').querySelector('[name*=\"conditional-value\"]').classList.remove('hidden');\n\t\n\t//hide extra fields\n\ttarget.closest('.rule-row').querySelectorAll('.equation-2, .conditional-field-2').forEach(function(el){\n\t\tel.classList.add('hidden');\n\t});\n\t\n\t//show both extra fields\n\tif(target.dataset.value == '-' || target.dataset.value == '+'){\n\t\ttarget.closest('.rule-row').querySelectorAll('.equation-2, .conditional-field-2').forEach(function(el){\n\t\t\tel.classList.remove('hidden');\n\t\t});\n\t//show extra conditional field\n\t}else if(target.dataset.value != undefined && target.dataset.value.includes('value')){\n\t\ttarget.closest('.rule-row').querySelector('.conditional-field-2').classList.remove('hidden');\n\n\t\t//hide normal conditional value field\n\t\ttarget.closest('.rule-row').querySelector('[name*=\"conditional-value\"]').classList.add('hidden');\n\t}else if(target.dataset.value != undefined && (\n\t\t\ttarget.dataset.value.includes('changed') || \n\t\t\ttarget.dataset.value.includes('clicked') ||\n\t\t\ttarget.dataset.value.includes('visible') ||\n\t\t\ttarget.dataset.value.includes('invisible') ||\n\t\t\ttarget.dataset.value.includes('checked')\n\t)){\n\t\ttarget.closest('.rule-row').querySelector('[name*=\"conditional-value\"]').classList.add('hidden');\n\t}\n}\n\nasync function addConditionRule(target){\n\tlet condition\t\t= target.closest('.condition-row');\n\tlet row\t\t\t\t= target.closest('.rule-row');\n\tlet activeButton\t= row.querySelector('.active');\n\t\n\tif(\n\t\t(\n\t\t\tactiveButton == null && \t\t\t\t\t\t\t\t\t\t\t\t\t// there is no active button\n\t\t\tcondition.querySelectorAll('.rule-row').length > 1 && \t\t\t\t\t\t// but there are more than one rules\n\t\t\trow.dataset.ruleIndex != condition.querySelectorAll('.rule-row').length -1\t// and this is not the last rule\n\t\t) ||\n\t\t(\n\t\t\tactiveButton != null && \t\t\t\t// there is an active button\n\t\t\t!target.classList.contains('active')\t// We clicked on the button which was not active\n\t\t)\n\t){\t\n\t\tlet current\t\t= 'OR';\n\t\tlet opposite\t= 'AND';\n\t\tlet makeActive\t= true;\n\t\t\n\t\tif(activeButton != null){\n\t\t\tif(activeButton.textContent == 'AND'){\n\t\t\t\tcurrent\t\t= 'AND';\n\t\t\t\topposite\t= 'OR';\n\t\t\t}\n\n\t\t\tlet options = {\n\t\t\t\ttitle: 'What do you want to do?',\n\t\t\t\tshowDenyButton: true,\n\t\t\t\tshowCancelButton: true,\n\t\t\t\tconfirmButtonText: `Change ${current} to ${opposite}`,\n\t\t\t\tdenyButtonText: 'Add a new rule',\n\t\t\t};\n\t\n\t\t\tif(document.fullscreenElement != null){\n\t\t\t\toptions['target']\t= document.fullscreenElement;\n\t\t\t}\n\t\t\t\n\t\t\tresult\t= await Swal.fire(options)\n\n\t\t\t//swap and/or\n\t\t\tif (result.isConfirmed) {\n\t\t\t\t//make other button inactive\n\t\t\t\tactiveButton.classList.remove('active');\n\t\t\t//add new rule after this one\n\t\t\t}else if (result.isDenied) {\n\t\t\t\taddRuleRow(row);\n\t\t\t\tmakeActive\t= false;\n\t\t\t}\n\t\t}\n\n\t\tif(makeActive){\n\t\t\t//make the button active\n\t\t\ttarget.classList.add('active');\n\t\t\t\n\t\t\t//store action \n\t\t\trow.querySelector('.combinator').value = target.textContent;\n\t\t}\n\t\t\t\n\t//add new rule at the end\n\t}else{\n\t\taddRuleRow(row);\n\t\t\n\t\t//make the button active\n\t\ttarget.classList.add('active');\n\t\t\n\t\t//store action \n\t\trow.querySelector('.combinator').value = target.textContent;\n\t}\n}\n\nfunction addRuleRow(row){\n\t//Insert a new rule row\n\tlet clone\t\t= FormFunctions.cloneNode(row);\n\t\n\tlet cloneIndex\t= parseInt(row.dataset.ruleIndex) + 1;\n\n\tclone.dataset.ruleIndex = cloneIndex;\n\n\trow.parentNode.insertBefore(clone, row.nextSibling);\n\t\n\tfixRuleNumbering(row.closest('.condition-row'));\n}\n\nfunction addOppositeCondition(clone, target){\n\t//Set values to opposite\n\tclone.querySelectorAll('.element-condition').forEach(function(el){\n\t\tif(el.matches('select:not(.nonice,.swal2-select)')){\n\t\t\tMain.attachNiceSelect(select);\n\t\t}\n\t\t\n\t\tif(el.tagName == 'SELECT' && el.classList.contains('equation')){\n\t\t\t//remove all default selected\n\t\t\tFormFunctions.removeDefaultSelect(el);\n\t\t\t\n\t\t\t//get the original value which was lost during cloning\n\t\t\tlet originalSelect \t= target.closest('.condition-row').querySelector('.equation');\n\t\t\tlet selIndex\t\t= originalSelect.selectedIndex;\n\t\t\t\n\t\t\tif(selIndex){\n\t\t\t\t//if odd the select the next one\n\t\t\t\tif(selIndex % 2){\n\t\t\t\t\tel.options[(selIndex + 1)].defaultSelected = true;\n\t\t\t\t}else{\n\t\t\t\t\tel.options[(selIndex - 1)].defaultSelected = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t//reflect changes in niceselect\n\t\t\tif(el._niceSelect != undefined){\n\t\t\t\tel._niceSelect.update();\n\t\t\t}\n\t\t}else if(el.type == 'radio' && el.classList.contains('element-condition') && (el.value == 'show' || el.value == 'hide')){\n\t\t\tif(!el.checked){\n\t\t\t\tel.checked = true;\n\t\t\t}else{\n\t\t\t\tel.checked = false;\n\t\t\t}\n\t\t}\n\t});\n\n\treturn clone;\n}\n\nfunction addCondition(target){\n\tlet clone;\n\tlet row = target.closest('.condition-row');\n\t\n\tif(target.classList.contains('opposite')){\n\t\tclone = FormFunctions.cloneNode(row, false);\n\t\tclone = addOppositeCondition(clone, target);\n\t}else{\n\t\tclone = FormFunctions.cloneNode(row);\n\t}\n\t\n\tlet cloneIndex\t= parseInt(row.dataset.conditionIndex) + 1;\n\n\tclone.dataset.conditionIndex = cloneIndex;\n\t\n\tif(!target.classList.contains('opposite')){\n\t\tclone.querySelectorAll('.active').forEach(function(el){\n\t\t\tel.classList.remove('active');\n\t\t});\n\t}\t\n\t\n\t//store radio values\n\tlet radioValues = {};\n\trow.querySelectorAll('input[type=\"radio\"]:checked').forEach(input=>{\n\t\tradioValues[input.value]\t= input.value;\n\t});\n\t\t\n\t//insert in page\n\trow.parentNode.insertBefore(clone, row.nextSibling);\n\t\n\tif(!target.classList.contains('opposite')){\n\t\t//remove unnecessy rulerows works only after html insert\n\t\tlet ruleCount = clone.querySelectorAll('.rule-row').length;\n\t\tclone.querySelectorAll('.rule-row').forEach(function(ruleRow){\n\t\t\t//only keep the last rule (as that one has the + button)\n\t\t\tif(ruleRow.dataset.ruleIndex != ruleCount - 1){\n\t\t\t\truleRow.remove();\n\t\t\t}else{\n\t\t\t\tfixRuleNumbering(ruleRow.closest('.condition-row'));\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//fix numbering\n\tfixConditionNumbering();\n\t\n\t//fix radio's as they get unselected due to same names on insert\n\trow.querySelectorAll('input[type=\"radio\"]').forEach(input=>{\n\t\tif(radioValues[input.value] != undefined){\n\t\t\tinput.checked = true;\n\t\t}\n\t});\n\t\n\t\n\t//hide button\n\ttarget.style.display = 'none';\n}\n\nfunction removeConditionRule(target){\n\tlet conditionRow = target.closest('.condition-row');\n\t\n\t//count rule rows in this condition row\n\tif(conditionRow.querySelectorAll('.rule-row').length > 1){\n\t\tlet options = {\n\t\t\ttitle: 'What do you want to remove?',\n\t\t\tshowDenyButton: true,\n\t\t\tshowCancelButton: true,\n\t\t\tconfirmButtonText: `One condition rule`,\n\t\t\tdenyButtonText: `The whole condition`,\n\t\t\tconfirmButtonColor: \"#bd2919\",\n\t\t};\n\n\t\tif(document.fullscreenElement != null){\n\t\t\toptions['target']\t= document.fullscreenElement;\n\t\t}\n\n\t\tSwal.fire(options).then((result) => {\n\t\t\t//remove a rule rowe\n\t\t\tif (result.isConfirmed) {\n\t\t\t\t//get the current row\n\t\t\t\tlet ruleRow\t\t= target.closest('.rule-row');\n\t\t\t\t\n\t\t\t\t//get the current row index\n\t\t\t\tlet ruleRowIndex\t= parseInt(ruleRow.dataset.ruleIndex);\n\t\t\t\t\n\t\t\t\t//Get previous row\n\t\t\t\tlet prevRow\t\t= conditionRow.querySelector('[data-rule_index=\"'+(ruleRowIndex - 1)+'\"]');\n\t\t\t\t\n\t\t\t\tif(prevRow != null){\n\t\t\t\t\t//remove the active class from row above if there is no row after this one\n\t\t\t\t\tif(conditionRow.querySelector(`[data-rule_index=\"${ruleRowIndex + 1}\"]`) == null){\n\t\t\t\t\t\tprevRow.querySelectorAll('.active').forEach(el=>el.classList.remove('active'));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t//clear the hidden input\n\t\t\t\t\tprevRow.querySelector('.combinator').value\t= '';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttarget.closest('.rule-row').remove();\n\t\t\t\t\n\t\t\t\tfixRuleNumbering(conditionRow);\n\t\t\t} else if (result.isDenied) {\n\t\t\t\tconditionRow.remove();\n\t\t\t\tfixConditionNumbering();\n\t\t\t}\n\t\t});\n\t}else{\n\t\tlet options = {\n\t\t\ttitle: 'Are you sure?',\n\t\t\ttext: \"This will remove this condition\",\n\t\t\ticon: 'warning',\n\t\t\tshowCancelButton: true,\n\t\t\tconfirmButtonColor: \"#bd2919\",\n\t\t\tcancelButtonColor: '#d33',\n\t\t\tconfirmButtonText: 'Yes, delete it!'\n\t\t};\n\n\t\tif(document.fullscreenElement != null){\n\t\t\toptions['target']\t= document.fullscreenElement;\n\t\t}\n\n\t\tSwal.fire(options).then((result) => {\n\t\t\tif (result.isConfirmed) {\n\t\t\t\tconditionRow.remove();\n\t\t\t\tfixConditionNumbering();\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction fixRuleNumbering(conditionRow){\n\tlet ruleRows\t= conditionRow.querySelectorAll('.element-conditions-wrapper .rule-row');\n\tlet i = 0;\n\t\n\t//loop over all rules in the condition\n\truleRows.forEach(ruleRow =>{\n\t\truleRow.dataset.ruleIndex = i;\n\t\t\n\t\truleRow.querySelectorAll('.element-condition').forEach(function(el){\n\t\t\t//fix numbering\n\t\t\tif(el.id != undefined){\n\t\t\t\tel.id = el.id.replace(/([0-9]+\\]\\[rules\\]\\[)[0-9]+/g,\"$1\"+i);\n\t\t\t}\n\t\t\t\t\n\t\t\tif(el.name != undefined){\n\t\t\t\tel.name = el.name.replace(/([0-9]+\\]\\[rules\\]\\[)[0-9]+/g,\"$1\"+i);\n\t\t\t}\n\t\t});\n\t\t\n\t\ti++;\n\t});\n}\n\nfunction fixConditionNumbering(){\n\tlet conditionRows\t= modal.querySelectorAll('.element-conditions-wrapper .condition-row');\n\tfor (let i = 0; i < conditionRows.length; i++) {\n\t\tconditionRows[i].dataset.conditionIndex = i;\n\t\t\n\t\tconditionRows[i].querySelectorAll('.element-condition').forEach(function(el){\n\t\t\t//fix numbering\n\t\t\tif(el.id != undefined){\n\t\t\t\tel.id = el.id.replace(/[0-9]+(\\]\\[rules\\]\\[[0-9]+)/g,i+\"$1\")\n\t\t\t\tel.id.replace(/[0-9]+(\\]\\[action\\])/g,i+\"$1\");\n\t\t\t\tel.id = el.id.replace(/(element-conditions\\[)[0-9]+\\]\\[+/g,\"$1\"+i+'][');\n\t\t\t}\n\t\t\tif(el.name != undefined){\n\t\t\t\tel.name = el.name.replace(/[0-9]+(\\]\\[rules\\]\\[[0-9]+)/g,i+\"$1\");\n\t\t\t\tel.name = el.name.replace(/[0-9]+(\\]\\[action\\])/g,i+\"$1\");\n\t\t\t\tel.name = el.name.replace(/(element-conditions\\[)[0-9]+\\]\\[+/g,\"$1\"+i+'][');\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction focusFirst(){\n\tmodal.scrollTo(0,0);\n\t\n\tconsole.log('scrolling')\n\tmodal.querySelector('[name=\"add-form-element-form\"] .nice-select').focus();\n}\n\nreorderingBusy = false;\ndocument.addEventListener(\"DOMContentLoaded\",function() {\n\n\t//Make the form-elements div sortable\n\tlet options = {\n\t\thandle: '.movecontrol',\n\t\tanimation: 150,\n\t\tonEnd: reorderformelements\n\t};\n\t\n\tdocument.querySelectorAll('.form-elements').forEach(el=>{Sortable.create(el, options);});\n\t\n\t//Listen to resize events on form-element-wrappers\n\tdocument.querySelectorAll('.resizer').forEach(el=>{resizeOb.observe(el);});\n});\n\nfunction fromEmailClicked(target){\n\tlet div1 = target.closest('.clone-div').querySelector('.emailfromfixed');\n\tlet div2 = target.closest('.clone-div').querySelector('.emailfromconditional');\n\n\tif(target.value == 'fixed'){\n\t\tdiv1.classList.remove('hidden');\n\t\tdiv2.classList.add('hidden');\n\t}else{\n\t\tdiv2.classList.remove('hidden');\n\t\tdiv1.classList.add('hidden');\n\t}\n}\n\nfunction toEmailClicked(target){\n\tlet div1 = target.closest('.clone-div').querySelector('.email-tofixed');\n\tlet div2 = target.closest('.clone-div').querySelector('.email-toconditional');\n\n\tif(target.value == 'fixed'){\n\t\tdiv1.classList.remove('hidden');\n\t\tdiv2.classList.add('hidden');\n\t}else{\n\t\tdiv2.classList.remove('hidden');\n\t\tdiv1.classList.add('hidden');\n\t}\n}\n\nfunction placeholderSelect(target){\n\tlet value = '';\n\tif(target.classList.contains('placeholders')){\n\t\tvalue = target.textContent;\n\t}else if(target.value != ''){\n\t\tvalue = target.value;\n\t\ttarget.selectedIndex = '0';\n\t}\n\t\n\tif(value != ''){\n\t\tlet options = {\n\t\t\ticon: 'success',\n\t\t\ttitle: 'Copied '+value,\n\t\t\tshowConfirmButton: false,\n\t\t\ttimer: 1500\n\t\t};\n\n\t\tif(document.fullscreenElement != null){\n\t\t\toptions['target']\t= document.fullscreenElement;\n\t\t}\n\n\t\tSwal.fire(options);\n\n\t\tnavigator.clipboard.writeText(value);\n\t}\n}\n\nfunction copyWarningCondition(target){\n\t//copy the row\n\tlet newNode = FormFunctions.cloneNode(target.closest('.warning-conditions'));\n\n\ttarget.closest('.conditions-wrapper').insertAdjacentElement('beforeEnd', newNode);\n\n\t//add the active class\n\ttarget.classList.add('active');\n\n\t//store the value\n\ttarget.closest('.warning-conditions').querySelector('.combinator').value = target.value;\n\n\tfixWarningConditionNumbering(target.closest('.conditions-wrapper'));\n}\n\nfunction removeWarningCondition(target){\n\tlet condition\t= target.closest('.warning-conditions');\n\n\t// Remove the active class of the previous conditions\n\tif(condition.nextElementSibling == null){\n\t\tcondition.previousElementSibling.querySelector('.active').classList.remove('active');\n\n\t\t//clear the value\n\t\tcondition.previousElementSibling.querySelector('.combinator').value='';\n\t}\n\n\t// remove the condition\n\tcondition.remove();\n\n\tfixWarningConditionNumbering(target.closest('.conditions-wrapper'));\n}\n\n//Catch click events\nwindow.addEventListener(\"click\", event => {\n\tlet target = event.target;\n\t\n\tformWrapper\t\t\t\t= target.closest('.sim-form-wrapper');\n\tformElementWrapper\t\t= target.closest('.form-element-wrapper');\n\t\n\tif(formWrapper != null){\n\t\tmodal = formWrapper.querySelector('.add-form-element-modal');\n\t}\n\t\n\t/* ELEMENT ACTIONS */\n\t\n\t//Show form edit controls\n\tif (target.name == 'show-id'){\n\t\tshowOrHideIds(target);\n\t}else if (target.name == 'show-name'){\n\t\tshowOrHideName(target);\n\t}else if(target.name == 'submit-form-element'){\n\t\tevent.stopPropagation();\n\t\taddFormElement(target);\n\t}else if(target.name == 'submit-form-condition'){\n\t\tsaveFormConditions(target);\n\t}else if(target.name == 'submit-form-setting'){\n\t\tsaveFormSettings(target);\n\t}else if(target.name == 'submit-form-emails'){\n\t\tsaveFormEmails(target);\n\t}else if(target.name == 'autoarchive'){\n\t\tlet el = target.closest('.formsettings-wrapper').querySelector('.auto-archive-logic');\n\t\tif(target.value == 1){\n\t\t\tel.classList.remove('hidden');\n\t\t}else{\n\t\t\tel.classList.add('hidden');\n\t\t}\n\t}else if(target.name == 'save-in-meta'){\n\t\ttarget.closest('.sim-form.builder').querySelector('.recurring-submissions').classList.toggle('hidden');\n\t}else if(target.name == 'formfield[mandatory]' && target.checked){\n\t\ttarget.closest('div').querySelector('[name=\"formfield[recommended]\"]').checked=true;\n\t}\n\t\n\t//request form values via AJAX\n\tif (target.classList.contains('edit-form-element')){\n\t\trequestEditElementData(target);\n\t}\n\n\tif (target.classList.contains('copy-form-element')){\n\t\ttarget.classList.add('clicked');\n\n\t\taddFormElement(target, true);\n\t}\n\n\tif (target.classList.contains('remove-form-element')){\n\t\tmaybeRemoveElement(target);\n\t}\n\n\t//open the modal to add an element\n\tif (target.classList.contains('add-form-element') || target.name == 'createform'){\n\t\tif( !window.location.href.includes('&formbuilder=true')){\n\t\t\twindow.location.href = window.location.href+'&formbuilder=true';\n\t\t\t\n\t\t\treturn;\n\t\t}\n\t\tshowEmptyModal(target);\n\t}\n\t\n\t//actions on element type select\n\tif (target.closest('.element-type') != null){\n\t\tshowCondionalFields(target.dataset.value, target.closest('form'));\n\t\t\n\t\t//if label type is selected, wrap by default\n\t\tif(target.dataset.value == 'label'){\n\t\t\ttarget.closest('form').querySelector('[name=\"formfield[wrap]\"]').checked\t\t= true;\n\t\t\ttarget.closest('form').querySelector('[name=\"formfield[wrap]\"]').defaultChecked\t= true\n\t\t}\n\t}\n\t\n\t/* ELEMENT CONDITION ACTIONS */\n\t//actions on condition equation select\n\tif (target.closest('.equation') != null){\n\t\tshowOrHideConditionFields(target);\n\t}\n\t\n\t//add new conditions_rule\n\tif (target.classList.contains('and-rule') || target.classList.contains('or-rule')){\n\t\taddConditionRule(target);\n\t}\n\t\n\t//add new condition row\n\tif (target.classList.contains('add-condition')){\n\t\taddCondition(target);\n\t}\n\t\n\t//remove  condition row\n\tif (target.classList.contains('remove-condition')){\n\t\tremoveConditionRule(target);\n\t}\n\t\n\t//show copy fields\n\tif (target.classList.contains('showcopyfields')){\n\t\tif(target.checked){\n\t\t\ttarget.closest('.copyfieldswrapper').querySelector('.copyfields').classList.remove('hidden');\n\t\t}else{\n\t\t\ttarget.closest('.copyfieldswrapper').querySelector('.copyfields').classList.add('hidden');\n\t\t}\n\t}\n\t\n\tif(target.classList.contains('email-trigger')){\n\t\tlet el = target.closest('.clone-div').querySelector('.conditional-field-wrapper');\n\t\tif(target.value == 'fieldchanged'){\n\t\t\tel.classList.remove('hidden');\n\t\t}else{\n\t\t\tel.classList.add('hidden');\n\t\t}\n\n\t\tel = target.closest('.clone-div').querySelector('.conditional-fields-wrapper');\n\t\tif(target.value == 'fieldschanged'){\n\t\t\tel.classList.remove('hidden');\n\t\t}else{\n\t\t\tel.classList.add('hidden');\n\t\t}\n\n\t\tel = target.closest('.clone-div').querySelector('.submitted-type');\n\t\tif(target.value == 'submittedcond'){\n\t\t\tel.classList.remove('hidden');\n\t\t}else{\n\t\t\tel.classList.add('hidden');\n\t\t}\n\t}\n\t\n\tif(target.classList.contains('from-email')){\n\t\tfromEmailClicked(target);\n\t}\n\t\n\tif(target.classList.contains('email-to')){\n\t\ttoEmailClicked(target);\n\t}\n\t\n\tif(target.classList.contains('placeholderselect') || target.classList.contains('placeholders')){\n\t\tplaceholderSelect(target);\n\t}\n\n\t//copy warning-conditions row\n\tif(target.matches('.warn-cond')){\n\t\tcopyWarningCondition(target);\n\t}\n\n\tif(target.matches('.remove-warn-cond')){\n\t\tremoveWarningCondition(target)\n\t}\n\n\tif(target.matches('.builder-permissions-rights-form')){\n\t\ttarget.closest('div').querySelector('.permission-wrapper').classList.toggle('hidden');\n\t}\n});\n\nwindow.addEventListener('change', ev=>{\n\tlet target\t= ev.target;\n\tif(target.matches('.meta_key')){\n\t\t//if this option has a keys data value\n\t\tlet metaIndexes\t= target.list.querySelector(`[value='${target.value}' i]`);\n\t\tif(metaIndexes != null && metaIndexes.dataset.keys != undefined){\n\t\t\tparent\t= target.closest('.warning-conditions').querySelector('.index-wrapper');\n\t\t\t//show the data key selector\n\t\t\tparent.classList.remove('hidden');\n\t\t\t\n\t\t\t//remove all options and add new ones\n\t\t\tlet datalist\t= parent.querySelector('.meta-key-index-list');\n\t\t\tfor(let i=1; i<datalist.options.length; i++) {\n\t\t\t\tdatalist.options[i].remove();\n\t\t\t}\n\n\t\t\t//add the new options\n\t\t\tmetaIndexes.dataset.keys.split(',').forEach(key=>{\n\t\t\t\tlet opt\t\t\t= document.createElement('option');\n\t\t\t\topt.value \t\t= key;\n\t\t\t\tdatalist.appendChild(opt);\n\t\t\t});\n\t\t}\n\t}else if(target.matches(\".condition-row [name*='[property-value]']\")){\n\t\tlet selectedElement\t= document.querySelector(`.form-element-wrapper[data-id=\"${target.value}\"]`);\n\t\tif(selectedElement == null){\n\t\t\treturn;\n\t\t}\n\n\t\tlet selectedElementType\t= selectedElement.dataset.type;\n\n\t\t// if select element is of number type\n\t\tif(selectedElementType == 'number'){\n\t\t\ttarget.closest('.condition-form').querySelectorAll('.addition.hidden').forEach(el=>el.classList.remove('hidden'));\n\t\t}else{\n\t\t\ttarget.closest('.condition-form').querySelectorAll('.addition:not(.hidden)').forEach(el=>el.classList.add('hidden'));\n\t\t}\n\t\t\n\t\t// if select element is of date type\n\t\tif(selectedElementType == 'date'){\n\t\t\ttarget.closest('.condition-form').querySelectorAll('.addition .days.hidden').forEach(el=>el.classList.remove('hidden'));\n\t\t}else{\n\t\t\ttarget.closest('.condition-form').querySelectorAll('.addition .days:not(.hidden)').forEach(el=>el.classList.add('hidden'));\n\t\t}\n\t}else if(target.matches(\"[name*='[submitted-trigger][equation]']\")){\n\t\tlet parent\t= target.closest('.submitted-trigger-type');\n\t\tlet static\t= parent.querySelector('.staticvalue');\n\t\tlet dynamic\t= parent.querySelector('div.dynamicvalue');\n\n\t\tif(dynamic != null){\n\t\t\n\t\t\tif(target.value == '==' || target.value == '!=' || target.value == '>' || target.value == '<'){\n\t\t\t\tstatic.classList.remove('hidden');\n\t\t\t\tdynamic.classList.add('hidden');\n\t\t\t}else if(target.value == 'checked' || target.value == '!checked'){\n\t\t\t\tdynamic.classList.add('hidden');\n\t\t\t\tstatic.classList.add('hidden');\n\t\t\t}else{\n\t\t\t\tdynamic.classList.remove('hidden');\n\t\t\t\tstatic.classList.add('hidden');\n\t\t\t}\n\t\t}\n\t}else if(target.name != undefined && target.name.includes('[equation')){\n\t\tlet warningsConditions\t= target.closest('.warning-conditions');\n\n\t\tif(warningsConditions != null){\n\t\t\tif( target.value == 'submitted'){\n\t\t\t\twarningsConditions.querySelector(`[name*='[conditional-value]']`).classList.add('hidden');\n\t\t\t}else{\n\t\t\t\twarningsConditions.querySelector(`[name*='[conditional-value]']`).classList.remove('hidden');\n\t\t\t}\n\t\t}\n\t}\n});\n\nfunction fixWarningConditionNumbering(parent){\n\tvar warningConditions\t= parent.querySelectorAll('.warning-conditions');\n\tvar i = 0;\n\t//loop over all rules in the condition\n\twarningConditions.forEach(condition =>{\n\t\tcondition.dataset.index = i;\n\t\t\n\t\tcondition.querySelectorAll('.warning-condition').forEach(function(el){\n\t\t\t//fix numbering\n\t\t\tif(el.name != undefined){\n\t\t\t\tel.name\t= el.name.replace(/([0-9])+/g,i);\n\t\t\t}\n\n\t\t\tif(el.id != undefined){\n\t\t\t\tel.id\t= el.id.replace(/([0-9])+/g,i);\n\t\t\t}\n\n\t\t\tif(el.list != undefined){\n\t\t\t\tel.setAttribute('list', el.list.id.replace(/([0-9])+/g,i));\n\t\t\t}\n\t\t});\n\t\t\n\t\ti++;\n\t});\n}\n\n"],"names":["reorderingBusy","formWrapper","formElementWrapper","modal","doit","clearFormInputs","querySelectorAll","forEach","el","type","checked","value","id","editor","tinyMCE","get","setContent","FormFunctions","removeDefaultSelect","undefined","_niceSelect","clear","update","hideConditionalfields","querySelector","err","console","error","fixElementNumbering","form","index","dataset","priority","async","addFormElement","target","copying","wrapper","adding","editing","closest","response","referenceNode","document","window","location","href","includes","combine","parseInt","loader","Main","showLoader","classList","add","indexes","JSON","stringify","formData","FormData","append","formId","FormSubmit","fetchRestApi","submitForm","outerHTML","html","resizeOb","observe","hideModals","displayMessage","message","remove","sendElementSize","widthPercentage","Math","abs","removeElement","parent","parentNode","elementWrapper","elementIndex","style","paddingRight","reorderformelements","event","options","icon","title","confirmButtonColor","fullscreenElement","Swal","fire","item","log","ResizeObserver","entries","element","width","contentRect","round","offsetWidth","textContent","clearTimeout","setTimeout","showCondionalFields","replace","addRuleRow","row","clone","cloneNode","cloneIndex","ruleIndex","insertBefore","nextSibling","fixRuleNumbering","conditionRow","ruleRows","i","ruleRow","name","fixConditionNumbering","conditionRows","length","conditionIndex","fixWarningConditionNumbering","warningConditions","condition","list","setAttribute","addEventListener","handle","animation","onEnd","Sortable","create","url","URL","action","searchParams","set","delete","history","pushState","showOrHideIds","showOrHideName","stopPropagation","saveFormConditions","saveFormSettings","saveFormEmails","toggle","contains","elementId","originalhtml","editButton","margin","innerHTML","elementForm","tinymce","execCommand","conditionsHtml","select","attachNiceSelect","showModal","requestEditElementData","text","showCancelButton","cancelButtonColor","confirmButtonText","then","result","isConfirmed","maybeRemoveElement","showEmptyModal","defaultChecked","showOrHideConditionFields","activeButton","current","opposite","makeActive","showDenyButton","denyButtonText","isDenied","addConditionRule","matches","tagName","selIndex","selectedIndex","defaultSelected","addOppositeCondition","radioValues","input","ruleCount","display","addCondition","ruleRowIndex","prevRow","removeConditionRule","div1","div2","fromEmailClicked","toEmailClicked","showConfirmButton","timer","navigator","clipboard","writeText","placeholderSelect","newNode","insertAdjacentElement","copyWarningCondition","nextElementSibling","previousElementSibling","removeWarningCondition","ev","metaIndexes","keys","datalist","split","key","opt","createElement","appendChild","selectedElement","selectedElementType","static","dynamic","warningsConditions"],"sourceRoot":""}